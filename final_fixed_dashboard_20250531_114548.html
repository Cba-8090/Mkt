
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sector Rotation Dashboard - Final Fixed</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-adapter-date-fns/3.0.0/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(90deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .dashboard {
            padding: 30px;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .grid-full {
            grid-column: 1 / -1;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid #e1e8ed;
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .heatmap-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .heatmap-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .heatmap-table th {
            background: #34495e;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9em;
            border: 1px solid #2c3e50;
        }

        .heatmap-table td {
            padding: 10px 12px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
            font-size: 0.9em;
            transition: all 0.2s;
        }

        .heatmap-table td:hover {
            transform: scale(1.05);
            z-index: 10;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .sector-name {
            background: #ecf0f1 !important;
            color: #2c3e50 !important;
            text-align: left !important;
            font-weight: 600 !important;
            max-width: 150px;
            word-wrap: break-word;
        }

        .signals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .signal-card {
            border-radius: 10px;
            padding: 15px;
            color: white;
            font-weight: 500;
        }

        .signal-strong-buy { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .signal-buy { background: linear-gradient(135deg, #f39c12, #e67e22); }
        .signal-sell { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .signal-strong-sell { background: linear-gradient(135deg, #8e44ad, #9b59b6); }

        .signal-title {
            font-size: 1.1em;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 5px;
        }

        .signal-item {
            background: rgba(255, 255, 255, 0.1);
            margin: 5px 0;
            padding: 8px;
            border-radius: 5px;
            font-size: 0.9em;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.8em;
            color: #495057;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }

            .dashboard {
                padding: 15px;
            }

            .heatmap-table th,
            .heatmap-table td {
                padding: 8px;
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Sector Rotation Dashboard</h1>
            <p>Advanced Analytics for Institutional Portfolio Management</p>
            <p>Generated on 2025-05-31 11:45:48 â€¢ Final Fixed Version</p>
        </div>

        <div class="dashboard">
            <!-- Debug Info -->
            <div class="debug-info">
                <strong>Debug Info:</strong> 
                Heatmap: 19 sectors | 
                Ratio data: 10 sectors (Auto, Bank, IT, Realty, Pharma, FMCG, Media, PSU_Bank, Energy, Metal) | 
                Signals: 2 total
            </div>

            <!-- Statistics Overview -->
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value">19</div>
                    <div class="stat-label">Total Sectors</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">0</div>
                    <div class="stat-label">Strong Signals</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">2</div>
                    <div class="stat-label">Buy Signals</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">0</div>
                    <div class="stat-label">Sell Signals</div>
                </div>
            </div>

            <div class="grid">
                <!-- Heatmap -->
                <div class="card grid-full">
                    <h3>Sector Performance Heatmap</h3>
                    <div class="heatmap-container">
                        <table class="heatmap-table" id="heatmapTable">
                            <thead>
                                <tr>
                                    <th>Sector</th>
                                    <th>7 Days</th>
                                    <th>30 Days</th>
                                    <th>90 Days</th>
                                </tr>
                            </thead>
                            <tbody id="heatmapBody">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Ratio Trends -->
                <div class="card">
                    <h3>Sector/Nifty Ratio Trends (Last 60 Days)</h3>
                    <div class="chart-container">
                        <canvas id="ratioChart"></canvas>
                    </div>
                </div>

                <!-- Performance Chart -->
                <div class="card">
                    <h3>30-Day Relative Performance</h3>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Rotation Signals -->
            <div class="card">
                <h3>Rotation Signals</h3>
                <div class="signals-grid">
                    <div class="signal-card signal-strong-buy">
                        <div class="signal-title">STRONG BUY (>15%)</div>
                        <div id="strongBuySignals"></div>
                    </div>
                    <div class="signal-card signal-buy">
                        <div class="signal-title">BUY (7-15%)</div>
                        <div id="buySignals"></div>
                    </div>
                    <div class="signal-card signal-sell">
                        <div class="signal-title">SELL (-7 to -15%)</div>
                        <div id="sellSignals"></div>
                    </div>
                    <div class="signal-card signal-strong-sell">
                        <div class="signal-title">STRONG SELL (<-15%)</div>
                        <div id="strongSellSignals"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data
        const heatmapData = [{"sector": "Nifty Auto", "perf_7d": -1.1454110227389558, "perf_30d": 5.3659740468358015, "perf_90d": 0}, {"sector": "Nifty Bank", "perf_7d": 0.8984437402507318, "perf_30d": -1.0810104145507604, "perf_90d": 0}, {"sector": "NIFTY IT", "perf_7d": 0.16025158718606392, "perf_30d": 8.065006990651447, "perf_90d": 0}, {"sector": "NIFTY INFRA", "perf_7d": -0.1435896868120916, "perf_30d": 0.1407462044918688, "perf_90d": 0}, {"sector": "NIFTY REALTY", "perf_7d": 1.0270123773377415, "perf_30d": 8.56647734122484, "perf_90d": 0}, {"sector": "NIFTY CONSUMPTION", "perf_7d": -0.7474595276119275, "perf_30d": -2.7357640813993402, "perf_90d": 0}, {"sector": "NIFTY PVT BANK", "perf_7d": 0.34634471235336517, "perf_30d": -2.1969507357979574, "perf_90d": 0}, {"sector": "NIFTY PHARMA", "perf_7d": -0.9432678597344801, "perf_30d": -2.2769201589261687, "perf_90d": 0}, {"sector": "NIFTY COMMODITIES", "perf_7d": -1.5420432644624098, "perf_30d": -2.1618693584482367, "perf_90d": 0}, {"sector": "NIFTY FMCG", "perf_7d": -1.1396013788369856, "perf_30d": -6.224073393641003, "perf_90d": 0}, {"sector": "NIFTY SERV SECTOR", "perf_7d": 0.2269995802311624, "perf_30d": -1.2632307399578835, "perf_90d": 0}, {"sector": "NIFTY MEDIA", "perf_7d": 1.6521978037582823, "perf_30d": 4.462009694110836, "perf_90d": 0}, {"sector": "NIFTY PSU BANK", "perf_7d": 4.04691586237663, "perf_30d": 3.1835145950551054, "perf_90d": 0}, {"sector": "NIFTY ENERGY", "perf_7d": 0.9032791971415876, "perf_30d": 2.389546586541848, "perf_90d": 0}, {"sector": "NIFTY METAL", "perf_7d": -0.4247910177296992, "perf_30d": 4.686389644028801, "perf_90d": 0}, {"sector": "NIFTY FIN SERVICE", "perf_7d": 0.4691528026117754, "perf_30d": -2.129050320745855, "perf_90d": 0}, {"sector": "NIFTY OIL AND GAS", "perf_7d": -0.48769781786176325, "perf_30d": 2.741947697770242, "perf_90d": 0}, {"sector": "NIFTY HEALTHCARE", "perf_7d": -1.2255859547949037, "perf_30d": -2.461271865930932, "perf_90d": 0}, {"sector": "NIFTY CONSR DURBL", "perf_7d": -1.0289781636303428, "perf_30d": -3.450600186076818, "perf_90d": 0}];
        const ratioData = {"Auto": [{"date": "2025-03-03", "ratio": 0.928517177306696}, {"date": "2025-03-04", "ratio": 0.9178789683303408}, {"date": "2025-03-05", "ratio": 0.9310323987232119}, {"date": "2025-03-06", "ratio": 0.9296952277031852}, {"date": "2025-03-07", "ratio": 0.9315907327347301}, {"date": "2025-03-11", "ratio": 0.9193146915934376}, {"date": "2025-03-12", "ratio": 0.9249326895262678}, {"date": "2025-03-13", "ratio": 0.9177062311360348}, {"date": "2025-03-18", "ratio": 0.9299584397156909}, {"date": "2025-03-19", "ratio": 0.9306736628891722}, {"date": "2025-03-20", "ratio": 0.9324037920455011}, {"date": "2025-03-21", "ratio": 0.9317185144579964}, {"date": "2025-03-24", "ratio": 0.9273131896349492}, {"date": "2025-03-25", "ratio": 0.9184131752339063}, {"date": "2025-03-26", "ratio": 0.9257435543719145}, {"date": "2025-03-27", "ratio": 0.9120377925521205}, {"date": "2025-03-31", "ratio": 0.9054459413206573}, {"date": "2025-04-01", "ratio": 0.9166677458483878}, {"date": "2025-04-03", "ratio": 0.9102756547283668}, {"date": "2025-04-04", "ratio": 0.8990894782454938}, {"date": "2025-04-07", "ratio": 0.8941389610858422}, {"date": "2025-04-09", "ratio": 0.8991591198773168}, {"date": "2025-04-11", "ratio": 0.9001294431753222}, {"date": "2025-04-15", "ratio": 0.9107381298880557}, {"date": "2025-04-16", "ratio": 0.9026590207021316}, {"date": "2025-04-17", "ratio": 0.8960847572390169}, {"date": "2025-04-21", "ratio": 0.904684038291355}, {"date": "2025-04-22", "ratio": 0.9063381228728962}, {"date": "2025-04-23", "ratio": 0.9217187753684397}, {"date": "2025-04-25", "ratio": 0.9149373839142906}, {"date": "2025-04-28", "ratio": 0.9187968843126375}, {"date": "2025-04-30", "ratio": 0.9167509102415531}, {"date": "2025-05-02", "ratio": 0.9153807292158691}, {"date": "2025-05-05", "ratio": 0.9279694536029581}, {"date": "2025-05-06", "ratio": 0.9326486078524668}, {"date": "2025-05-07", "ratio": 0.9467404482600431}, {"date": "2025-05-08", "ratio": 0.9340997289258378}, {"date": "2025-05-12", "ratio": 0.9388458035603237}, {"date": "2025-05-13", "ratio": 0.942587683876257}, {"date": "2025-05-14", "ratio": 0.9468903672532826}, {"date": "2025-05-15", "ratio": 0.9498346108267065}, {"date": "2025-05-16", "ratio": 0.9573677647303337}, {"date": "2025-05-19", "ratio": 0.9642079016413814}, {"date": "2025-05-20", "ratio": 0.9533015447315861}, {"date": "2025-05-21", "ratio": 0.955131188931809}, {"date": "2025-05-22", "ratio": 0.9532785852732866}, {"date": "2025-05-23", "ratio": 0.9461677895960874}, {"date": "2025-05-26", "ratio": 0.9504822778152205}, {"date": "2025-05-27", "ratio": 0.9504837631212187}, {"date": "2025-05-28", "ratio": 0.9468577857949415}, {"date": "2025-05-29", "ratio": 0.9485435055730945}, {"date": "2025-05-30", "ratio": 0.9424218304936829}], "Bank": [{"date": "2025-03-03", "ratio": 2.1752180222701445}, {"date": "2025-03-04", "ratio": 2.184755905654439}, {"date": "2025-03-05", "ratio": 2.1708062299382647}, {"date": "2025-03-06", "ratio": 2.1569459784339555}, {"date": "2025-03-07", "ratio": 2.1504267819532203}, {"date": "2025-03-11", "ratio": 2.1270407460251843}, {"date": "2025-03-12", "ratio": 2.138655125609132}, {"date": "2025-03-13", "ratio": 2.145821799153466}, {"date": "2025-03-18", "ratio": 2.1596676929005927}, {"date": "2025-03-19", "ratio": 2.1696991391503255}, {"date": "2025-03-20", "ratio": 2.1587514795833664}, {"date": "2025-03-21", "ratio": 2.1667102062491437}, {"date": "2025-03-24", "ratio": 2.1854841947980312}, {"date": "2025-03-25", "ratio": 2.1804348790488683}, {"date": "2025-03-26", "ratio": 2.180326437985511}, {"date": "2025-03-27", "ratio": 2.1861630768122176}, {"date": "2025-03-31", "ratio": 2.192443668723838}, {"date": "2025-04-01", "ratio": 2.1940843574767865}, {"date": "2025-04-02", "ratio": 2.2007234590600606}, {"date": "2025-04-03", "ratio": 2.2192313151341287}, {"date": "2025-04-04", "ratio": 2.248589247940902}, {"date": "2025-04-07", "ratio": 2.249842069164681}, {"date": "2025-04-09", "ratio": 2.2429489511878797}, {"date": "2025-04-11", "ratio": 2.2341475915027456}, {"date": "2025-04-15", "ratio": 2.245295999965707}, {"date": "2025-04-16", "ratio": 2.2663863430785245}, {"date": "2025-04-17", "ratio": 2.2761611880100534}, {"date": "2025-04-21", "ratio": 2.2923622466638065}, {"date": "2025-04-22", "ratio": 2.3025871789301635}, {"date": "2025-04-23", "ratio": 2.2758914790815057}, {"date": "2025-04-24", "ratio": 2.2766562047618852}, {"date": "2025-04-25", "ratio": 2.2739404351615167}, {"date": "2025-04-28", "ratio": 2.2785128552931746}, {"date": "2025-04-29", "ratio": 2.2761079801692556}, {"date": "2025-04-30", "ratio": 2.2637748518545915}, {"date": "2025-05-02", "ratio": 2.263770860116566}, {"date": "2025-05-05", "ratio": 2.2451724469209338}, {"date": "2025-05-06", "ratio": 2.2260988695466706}, {"date": "2025-05-07", "ratio": 2.236831542040763}, {"date": "2025-05-08", "ratio": 2.2396843510286812}, {"date": "2025-05-09", "ratio": 2.2323912862379207}, {"date": "2025-05-12", "ratio": 2.2220066841326074}, {"date": "2025-05-13", "ratio": 2.235335162856742}, {"date": "2025-05-14", "ratio": 2.221653308684918}, {"date": "2025-05-15", "ratio": 2.2087374960597876}, {"date": "2025-05-16", "ratio": 2.2124437445543133}, {"date": "2025-05-19", "ratio": 2.221675696369478}, {"date": "2025-05-20", "ratio": 2.2232041938267453}, {"date": "2025-05-21", "ratio": 2.219566404510457}, {"date": "2025-05-22", "ratio": 2.2325058818270844}, {"date": "2025-05-23", "ratio": 2.2290232827629493}, {"date": "2025-05-26", "ratio": 2.2227777522233976}, {"date": "2025-05-27", "ratio": 2.229612264462544}, {"date": "2025-05-28", "ratio": 2.2388490836260653}, {"date": "2025-05-29", "ratio": 2.2367296727015016}, {"date": "2025-05-30", "ratio": 2.252449425672809}], "IT": [{"date": "2025-03-03", "ratio": 1.7005262372679062}, {"date": "2025-03-04", "ratio": 1.6880650646548305}, {"date": "2025-03-05", "ratio": 1.7044271241376534}, {"date": "2025-03-06", "ratio": 1.6919852559581632}, {"date": "2025-03-07", "ratio": 1.6769958984591506}, {"date": "2025-03-11", "ratio": 1.6623818223034148}, {"date": "2025-03-12", "ratio": 1.6159253243141007}, {"date": "2025-03-13", "ratio": 1.6128132087939564}, {"date": "2025-03-18", "ratio": 1.6036992594474102}, {"date": "2025-03-19", "ratio": 1.581287432991671}, {"date": "2025-03-20", "ratio": 1.5815274690446366}, {"date": "2025-03-21", "ratio": 1.5718274633410991}, {"date": "2025-03-24", "ratio": 1.573104210564135}, {"date": "2025-03-25", "ratio": 1.593115788183948}, {"date": "2025-03-26", "ratio": 1.5896852919825348}, {"date": "2025-03-27", "ratio": 1.5915725491110315}, {"date": "2025-03-31", "ratio": 1.5683320329856056}, {"date": "2025-04-01", "ratio": 1.5531863919501676}, {"date": "2025-04-03", "ratio": 1.4949290540685847}, {"date": "2025-04-04", "ratio": 1.4630955993267685}, {"date": "2025-04-07", "ratio": 1.4741173922460473}, {"date": "2025-04-09", "ratio": 1.4517224983983765}, {"date": "2025-04-11", "ratio": 1.4342062899308103}, {"date": "2025-04-15", "ratio": 1.4263766929363377}, {"date": "2025-04-16", "ratio": 1.4206261840151553}, {"date": "2025-04-17", "ratio": 1.399163160619915}, {"date": "2025-04-21", "ratio": 1.4148920957242428}, {"date": "2025-04-22", "ratio": 1.40442334150555}, {"date": "2025-04-23", "ratio": 1.4556587933305793}, {"date": "2025-04-25", "ratio": 1.4793349237812172}, {"date": "2025-04-28", "ratio": 1.4584931253468154}, {"date": "2025-04-30", "ratio": 1.4709729516482972}, {"date": "2025-05-02", "ratio": 1.4741977352166822}, {"date": "2025-05-05", "ratio": 1.471363774802084}, {"date": "2025-05-06", "ratio": 1.471279266271801}, {"date": "2025-05-07", "ratio": 1.471275149092339}, {"date": "2025-05-08", "ratio": 1.483181454901993}, {"date": "2025-05-12", "ratio": 1.5359282157859473}, {"date": "2025-05-13", "ratio": 1.5198172375281498}, {"date": "2025-05-14", "ratio": 1.5345888619972514}, {"date": "2025-05-15", "ratio": 1.5279565559151072}, {"date": "2025-05-16", "ratio": 1.517691987945547}, {"date": "2025-05-19", "ratio": 1.5023902154501123}, {"date": "2025-05-20", "ratio": 1.5104379777911918}, {"date": "2025-05-21", "ratio": 1.512893209126502}, {"date": "2025-05-22", "ratio": 1.505507990751614}, {"date": "2025-05-23", "ratio": 1.5049822658294825}, {"date": "2025-05-26", "ratio": 1.5113664771420514}, {"date": "2025-05-28", "ratio": 1.5136178438902008}, {"date": "2025-05-29", "ratio": 1.5202850170736424}, {"date": "2025-05-30", "ratio": 1.5079068470790724}], "Realty": [{"date": "2025-03-03", "ratio": 0.036526924450592926}, {"date": "2025-03-04", "ratio": 0.03662377477340808}, {"date": "2025-03-05", "ratio": 0.037047897462987915}, {"date": "2025-03-06", "ratio": 0.03664497642461421}, {"date": "2025-03-07", "ratio": 0.03619776078040129}, {"date": "2025-03-11", "ratio": 0.03683454900235133}, {"date": "2025-03-12", "ratio": 0.03627200106806702}, {"date": "2025-03-13", "ratio": 0.03572544782383512}, {"date": "2025-03-18", "ratio": 0.03601161410684803}, {"date": "2025-03-19", "ratio": 0.03690260001047688}, {"date": "2025-03-20", "ratio": 0.03684243434315122}, {"date": "2025-03-21", "ratio": 0.03694797519528573}, {"date": "2025-03-24", "ratio": 0.03702498272280189}, {"date": "2025-03-25", "ratio": 0.0364701831325403}, {"date": "2025-03-26", "ratio": 0.036277746909440814}, {"date": "2025-03-27", "ratio": 0.036603587240562986}, {"date": "2025-03-31", "ratio": 0.036195728198270785}, {"date": "2025-04-01", "ratio": 0.03560652171097787}, {"date": "2025-04-03", "ratio": 0.036722422699257205}, {"date": "2025-04-04", "ratio": 0.03593406521440157}, {"date": "2025-04-07", "ratio": 0.035024546964118115}, {"date": "2025-04-09", "ratio": 0.03483614333579622}, {"date": "2025-04-11", "ratio": 0.03461236039958736}, {"date": "2025-04-15", "ratio": 0.035782335378752646}, {"date": "2025-04-16", "ratio": 0.03587459252811769}, {"date": "2025-04-17", "ratio": 0.03543151102753898}, {"date": "2025-04-21", "ratio": 0.03581680003150187}, {"date": "2025-04-22", "ratio": 0.03661980572882723}, {"date": "2025-04-23", "ratio": 0.0368593794635609}, {"date": "2025-04-25", "ratio": 0.03574763876727116}, {"date": "2025-04-28", "ratio": 0.035822183858437634}, {"date": "2025-04-30", "ratio": 0.03640349795760699}, {"date": "2025-05-02", "ratio": 0.036208192486045336}, {"date": "2025-05-05", "ratio": 0.03627589054480267}, {"date": "2025-05-06", "ratio": 0.035094915421089765}, {"date": "2025-05-07", "ratio": 0.03543605413198768}, {"date": "2025-05-08", "ratio": 0.03476175959264721}, {"date": "2025-05-12", "ratio": 0.03500944845875778}, {"date": "2025-05-13", "ratio": 0.03524646691091957}, {"date": "2025-05-14", "ratio": 0.035715878363312775}, {"date": "2025-05-15", "ratio": 0.03582900076210693}, {"date": "2025-05-16", "ratio": 0.036473113294270935}, {"date": "2025-05-19", "ratio": 0.03740962780787679}, {"date": "2025-05-20", "ratio": 0.037384692046232564}, {"date": "2025-05-21", "ratio": 0.03783028962115304}, {"date": "2025-05-22", "ratio": 0.03796876841245525}, {"date": "2025-05-23", "ratio": 0.037695422914197994}, {"date": "2025-05-26", "ratio": 0.03775826311989648}, {"date": "2025-05-28", "ratio": 0.038173998937478915}, {"date": "2025-05-29", "ratio": 0.03848415050576638}, {"date": "2025-05-30", "ratio": 0.038356490927529324}], "Pharma": [{"date": "2025-03-03", "ratio": 0.8987535771927683}, {"date": "2025-03-04", "ratio": 0.8975666416847615}, {"date": "2025-03-05", "ratio": 0.9010399645436109}, {"date": "2025-03-06", "ratio": 0.9059047137464681}, {"date": "2025-03-07", "ratio": 0.9035938366034807}, {"date": "2025-03-11", "ratio": 0.9037332373243724}, {"date": "2025-03-12", "ratio": 0.9089250350459491}, {"date": "2025-03-13", "ratio": 0.9102410122693907}, {"date": "2025-03-18", "ratio": 0.9214777768532427}, {"date": "2025-03-19", "ratio": 0.9230844785136811}, {"date": "2025-03-20", "ratio": 0.9202243145405582}, {"date": "2025-03-21", "ratio": 0.9261468754282582}, {"date": "2025-03-24", "ratio": 0.9202311234722625}, {"date": "2025-03-25", "ratio": 0.9101702040462806}, {"date": "2025-03-26", "ratio": 0.9094706186653383}, {"date": "2025-03-27", "ratio": 0.9017970112686743}, {"date": "2025-03-31", "ratio": 0.8987259426812392}, {"date": "2025-04-01", "ratio": 0.8966618750998242}, {"date": "2025-04-03", "ratio": 0.921439047573989}, {"date": "2025-04-04", "ratio": 0.8976421612394098}, {"date": "2025-04-07", "ratio": 0.9022588621760163}, {"date": "2025-04-09", "ratio": 0.8918329490181546}, {"date": "2025-04-11", "ratio": 0.8963293770300786}, {"date": "2025-04-15", "ratio": 0.8964209091435174}, {"date": "2025-04-16", "ratio": 0.8906482002969638}, {"date": "2025-04-17", "ratio": 0.8857563313229901}, {"date": "2025-04-21", "ratio": 0.8849974404728597}, {"date": "2025-04-22", "ratio": 0.8870703120959149}, {"date": "2025-04-23", "ratio": 0.8935424668964341}, {"date": "2025-04-25", "ratio": 0.8936410510267541}, {"date": "2025-04-28", "ratio": 0.900511745483692}, {"date": "2025-04-30", "ratio": 0.8947263522121129}, {"date": "2025-05-02", "ratio": 0.8883113522571847}, {"date": "2025-05-05", "ratio": 0.8902177534580344}, {"date": "2025-05-06", "ratio": 0.8832938194227961}, {"date": "2025-05-07", "ratio": 0.8790897994626122}, {"date": "2025-05-08", "ratio": 0.8698699832741474}, {"date": "2025-05-12", "ratio": 0.8466581343005132}, {"date": "2025-05-13", "ratio": 0.8690473526497914}, {"date": "2025-05-14", "ratio": 0.8708228435676959}, {"date": "2025-05-15", "ratio": 0.8638801217775048}, {"date": "2025-05-16", "ratio": 0.8646432025835539}, {"date": "2025-05-19", "ratio": 0.8715196558891501}, {"date": "2025-05-20", "ratio": 0.8692366279234643}, {"date": "2025-05-21", "ratio": 0.8754788229770548}, {"date": "2025-05-22", "ratio": 0.8745230539177641}, {"date": "2025-05-23", "ratio": 0.862435948763034}, {"date": "2025-05-26", "ratio": 0.8600324385078285}, {"date": "2025-05-28", "ratio": 0.8642902015760056}, {"date": "2025-05-29", "ratio": 0.8693604632433477}, {"date": "2025-05-30", "ratio": 0.866320952538716}], "FMCG": [{"date": "2025-03-03", "ratio": 2.2960333283603007}, {"date": "2025-03-04", "ratio": 2.287961363332752}, {"date": "2025-03-05", "ratio": 2.295671365832039}, {"date": "2025-03-06", "ratio": 2.301662918557355}, {"date": "2025-03-07", "ratio": 2.3009333776743155}, {"date": "2025-03-11", "ratio": 2.3091688557598706}, {"date": "2025-03-12", "ratio": 2.312242718230569}, {"date": "2025-03-13", "ratio": 2.316327487364492}, {"date": "2025-03-18", "ratio": 2.2980778915929108}, {"date": "2025-03-19", "ratio": 2.2780256334142384}, {"date": "2025-03-20", "ratio": 2.2792763462861108}, {"date": "2025-03-21", "ratio": 2.2691709777990954}, {"date": "2025-03-24", "ratio": 2.2500618174978393}, {"date": "2025-03-25", "ratio": 2.244796386781671}, {"date": "2025-03-26", "ratio": 2.2560922388485474}, {"date": "2025-03-27", "ratio": 2.2582533448909476}, {"date": "2025-03-31", "ratio": 2.2785408610357005}, {"date": "2025-04-01", "ratio": 2.292257518659052}, {"date": "2025-04-03", "ratio": 2.3142588634027383}, {"date": "2025-04-04", "ratio": 2.3502288856532245}, {"date": "2025-04-07", "ratio": 2.402405512237384}, {"date": "2025-04-09", "ratio": 2.4672699633691457}, {"date": "2025-04-11", "ratio": 2.4417275735865833}, {"date": "2025-04-15", "ratio": 2.3960747667557563}, {"date": "2025-04-16", "ratio": 2.4041097059375693}, {"date": "2025-04-17", "ratio": 2.3761123444290013}, {"date": "2025-04-21", "ratio": 2.326587373137607}, {"date": "2025-04-22", "ratio": 2.366582875585762}, {"date": "2025-04-23", "ratio": 2.3633531245697}, {"date": "2025-04-25", "ratio": 2.3516588426891745}, {"date": "2025-04-28", "ratio": 2.327323920504758}, {"date": "2025-04-30", "ratio": 2.319589302298822}, {"date": "2025-05-02", "ratio": 2.3104671269617647}, {"date": "2025-05-05", "ratio": 2.327617466881156}, {"date": "2025-05-06", "ratio": 2.3332376248995064}, {"date": "2025-05-07", "ratio": 2.317904597286847}, {"date": "2025-05-08", "ratio": 2.3078669182410665}, {"date": "2025-05-12", "ratio": 2.290956360558001}, {"date": "2025-05-13", "ratio": 2.2920232643769824}, {"date": "2025-05-14", "ratio": 2.2845067681792197}, {"date": "2025-05-15", "ratio": 2.2618196400142048}, {"date": "2025-05-16", "ratio": 2.2806657127554977}, {"date": "2025-05-19", "ratio": 2.283209964141757}, {"date": "2025-05-20", "ratio": 2.2770409052054172}, {"date": "2025-05-21", "ratio": 2.273490788262011}, {"date": "2025-05-22", "ratio": 2.2591925135210915}, {"date": "2025-05-23", "ratio": 2.2734361640274976}, {"date": "2025-05-26", "ratio": 2.2818830333804643}, {"date": "2025-05-28", "ratio": 2.250437835446592}, {"date": "2025-05-29", "ratio": 2.2401282939243607}, {"date": "2025-05-30", "ratio": 2.2335933933181686}], "Media": [{"date": "2025-03-03", "ratio": 0.06200693512000832}, {"date": "2025-03-04", "ratio": 0.06358159007184373}, {"date": "2025-03-05", "ratio": 0.06482878414132415}, {"date": "2025-03-06", "ratio": 0.06485781580593221}, {"date": "2025-03-07", "ratio": 0.06602150537634409}, {"date": "2025-03-11", "ratio": 0.06589281666288853}, {"date": "2025-03-12", "ratio": 0.06496295142520193}, {"date": "2025-03-13", "ratio": 0.06419552444055507}, {"date": "2025-03-18", "ratio": 0.06482134332999041}, {"date": "2025-03-19", "ratio": 0.06531238540920918}, {"date": "2025-03-20", "ratio": 0.06530433601473007}, {"date": "2025-03-21", "ratio": 0.06628151980265863}, {"date": "2025-03-24", "ratio": 0.06546103172875539}, {"date": "2025-03-25", "ratio": 0.06438897022010127}, {"date": "2025-03-26", "ratio": 0.06332692549234997}, {"date": "2025-03-27", "ratio": 0.06400064428756419}, {"date": "2025-03-31", "ratio": 0.06272494775578408}, {"date": "2025-04-01", "ratio": 0.06510919160655625}, {"date": "2025-04-03", "ratio": 0.06598251190317461}, {"date": "2025-04-04", "ratio": 0.06498737144965279}, {"date": "2025-04-07", "ratio": 0.06452151469208}, {"date": "2025-04-09", "ratio": 0.0660382202003201}, {"date": "2025-04-11", "ratio": 0.06587365382383024}, {"date": "2025-04-15", "ratio": 0.06637574988586946}, {"date": "2025-04-16", "ratio": 0.06731179492430836}, {"date": "2025-04-17", "ratio": 0.0662910113136827}, {"date": "2025-04-21", "ratio": 0.06616429470001721}, {"date": "2025-04-22", "ratio": 0.0661494377721917}, {"date": "2025-04-23", "ratio": 0.0656522373550852}, {"date": "2025-04-25", "ratio": 0.06438402036660726}, {"date": "2025-04-28", "ratio": 0.06412027046468134}, {"date": "2025-04-30", "ratio": 0.06221285269291779}, {"date": "2025-05-02", "ratio": 0.06248690787663214}, {"date": "2025-05-05", "ratio": 0.06259313237521538}, {"date": "2025-05-06", "ratio": 0.06185499351917177}, {"date": "2025-05-07", "ratio": 0.0624221770758241}, {"date": "2025-05-08", "ratio": 0.06290939201937892}, {"date": "2025-05-12", "ratio": 0.06379615401589588}, {"date": "2025-05-13", "ratio": 0.06576926441359977}, {"date": "2025-05-14", "ratio": 0.06636626410290714}, {"date": "2025-05-15", "ratio": 0.06635716879271888}, {"date": "2025-05-16", "ratio": 0.06720477381913526}, {"date": "2025-05-19", "ratio": 0.06701021629194903}, {"date": "2025-05-20", "ratio": 0.06679657590575233}, {"date": "2025-05-21", "ratio": 0.06672590873095036}, {"date": "2025-05-22", "ratio": 0.0680239905403154}, {"date": "2025-05-23", "ratio": 0.06772380965793068}, {"date": "2025-05-26", "ratio": 0.06765688778316196}, {"date": "2025-05-28", "ratio": 0.06898509036479217}, {"date": "2025-05-29", "ratio": 0.06890060240963855}, {"date": "2025-05-30", "ratio": 0.06914147882686146}], "PSU_Bank": [{"date": "2025-03-03", "ratio": 0.25458536210458743}, {"date": "2025-03-04", "ratio": 0.25897707023387134}, {"date": "2025-03-05", "ratio": 0.26370465544179467}, {"date": "2025-03-06", "ratio": 0.2629952937941068}, {"date": "2025-03-07", "ratio": 0.26300410154084913}, {"date": "2025-03-11", "ratio": 0.2587885980469288}, {"date": "2025-03-12", "ratio": 0.25630048285529916}, {"date": "2025-03-13", "ratio": 0.258239869269373}, {"date": "2025-03-18", "ratio": 0.2584992752131661}, {"date": "2025-03-19", "ratio": 0.2627665054392429}, {"date": "2025-03-20", "ratio": 0.26065892935299356}, {"date": "2025-03-21", "ratio": 0.26256295395367957}, {"date": "2025-03-24", "ratio": 0.2673939644987922}, {"date": "2025-03-25", "ratio": 0.26266601601696754}, {"date": "2025-03-26", "ratio": 0.2615420969606397}, {"date": "2025-03-27", "ratio": 0.26687704916295596}, {"date": "2025-03-31", "ratio": 0.26630838012104924}, {"date": "2025-04-01", "ratio": 0.2699853662958598}, {"date": "2025-04-03", "ratio": 0.27626547842804977}, {"date": "2025-04-04", "ratio": 0.2736127695709786}, {"date": "2025-04-07", "ratio": 0.27476355497797994}, {"date": "2025-04-09", "ratio": 0.2719991606824366}, {"date": "2025-04-11", "ratio": 0.27033254411690627}, {"date": "2025-04-15", "ratio": 0.26870079794929386}, {"date": "2025-04-16", "ratio": 0.273797637943099}, {"date": "2025-04-17", "ratio": 0.2734611651604815}, {"date": "2025-04-21", "ratio": 0.27704653365415505}, {"date": "2025-04-22", "ratio": 0.27865396352501837}, {"date": "2025-04-23", "ratio": 0.27522766087315725}, {"date": "2025-04-25", "ratio": 0.2718667518048533}, {"date": "2025-04-28", "ratio": 0.27519164765604126}, {"date": "2025-04-30", "ratio": 0.26885001356116084}, {"date": "2025-05-02", "ratio": 0.26921307610476986}, {"date": "2025-05-05", "ratio": 0.2678573983643451}, {"date": "2025-05-06", "ratio": 0.25575481139969486}, {"date": "2025-05-07", "ratio": 0.2561254833213185}, {"date": "2025-05-08", "ratio": 0.2541196681195363}, {"date": "2025-05-12", "ratio": 0.2596380297455937}, {"date": "2025-05-13", "ratio": 0.2674101394113112}, {"date": "2025-05-14", "ratio": 0.26795422205465624}, {"date": "2025-05-15", "ratio": 0.2642097030975058}, {"date": "2025-05-16", "ratio": 0.26493417213566856}, {"date": "2025-05-19", "ratio": 0.26960026778430535}, {"date": "2025-05-20", "ratio": 0.2699148027661755}, {"date": "2025-05-21", "ratio": 0.27030098595721275}, {"date": "2025-05-22", "ratio": 0.27094804081317525}, {"date": "2025-05-23", "ratio": 0.2696921718172545}, {"date": "2025-05-26", "ratio": 0.2685596462562722}, {"date": "2025-05-28", "ratio": 0.2746031200951825}, {"date": "2025-05-29", "ratio": 0.2730453901166162}, {"date": "2025-05-30", "ratio": 0.28185061432605946}], "Energy": [{"date": "2025-03-03", "ratio": 1.356600344495531}, {"date": "2025-03-05", "ratio": 1.3922654036074191}, {"date": "2025-03-06", "ratio": 1.4074194821842827}, {"date": "2025-03-07", "ratio": 1.4095310941137347}, {"date": "2025-03-11", "ratio": 1.3984705239155655}, {"date": "2025-03-13", "ratio": 1.4056667797760434}, {"date": "2025-03-20", "ratio": 1.4230325583802093}, {"date": "2025-03-24", "ratio": 1.4352226592302506}, {"date": "2025-03-26", "ratio": 1.4137868637130993}, {"date": "2025-03-27", "ratio": 1.4277306454108285}, {"date": "2025-03-31", "ratio": 1.4274033933760926}, {"date": "2025-04-01", "ratio": 1.437001687840212}, {"date": "2025-04-03", "ratio": 1.4434260497804312}, {"date": "2025-04-04", "ratio": 1.410594884400193}, {"date": "2025-04-07", "ratio": 1.4175217493321783}, {"date": "2025-04-15", "ratio": 1.4191430671859162}, {"date": "2025-04-16", "ratio": 1.4275126721622038}, {"date": "2025-04-17", "ratio": 1.416987923267363}, {"date": "2025-04-21", "ratio": 1.4358532758838658}, {"date": "2025-04-22", "ratio": 1.4282282841448655}, {"date": "2025-04-23", "ratio": 1.4285470601896095}, {"date": "2025-04-28", "ratio": 1.4196867871015475}, {"date": "2025-04-30", "ratio": 1.4071389238191516}, {"date": "2025-05-06", "ratio": 1.3852196098377332}, {"date": "2025-05-07", "ratio": 1.3945888492037486}, {"date": "2025-05-08", "ratio": 1.3815204047161962}, {"date": "2025-05-12", "ratio": 1.3935694311265532}, {"date": "2025-05-13", "ratio": 1.4056781679811705}, {"date": "2025-05-14", "ratio": 1.4205575082397868}, {"date": "2025-05-15", "ratio": 1.410997083245219}, {"date": "2025-05-16", "ratio": 1.4254630332776443}, {"date": "2025-05-19", "ratio": 1.4307559093942983}, {"date": "2025-05-20", "ratio": 1.4355571850477435}, {"date": "2025-05-21", "ratio": 1.4366039385897567}, {"date": "2025-05-22", "ratio": 1.4367139786344407}, {"date": "2025-05-28", "ratio": 1.4498988988968768}, {"date": "2025-05-29", "ratio": 1.44919383416017}, {"date": "2025-05-30", "ratio": 1.4496175865733092}], "Metal": [{"date": "2025-03-03", "ratio": 0.37597482741316407}, {"date": "2025-03-04", "ratio": 0.37802301807074784}, {"date": "2025-03-05", "ratio": 0.3888204930766029}, {"date": "2025-03-06", "ratio": 0.39426783235084073}, {"date": "2025-03-07", "ratio": 0.39582751357942575}, {"date": "2025-03-11", "ratio": 0.3954724663190786}, {"date": "2025-03-12", "ratio": 0.3940410760775238}, {"date": "2025-03-13", "ratio": 0.3919083635454432}, {"date": "2025-03-18", "ratio": 0.3956087990435442}, {"date": "2025-03-19", "ratio": 0.39936745883462255}, {"date": "2025-03-20", "ratio": 0.3990444424800512}, {"date": "2025-03-21", "ratio": 0.3941495648896806}, {"date": "2025-03-24", "ratio": 0.3915256135782927}, {"date": "2025-03-25", "ratio": 0.3858648465375084}, {"date": "2025-03-26", "ratio": 0.3873529230186254}, {"date": "2025-03-27", "ratio": 0.3882595546362212}, {"date": "2025-03-31", "ratio": 0.3865965683575439}, {"date": "2025-04-01", "ratio": 0.38923278813072776}, {"date": "2025-04-03", "ratio": 0.3873166136919841}, {"date": "2025-04-04", "ratio": 0.3673718425895405}, {"date": "2025-04-07", "ratio": 0.354051602772363}, {"date": "2025-04-09", "ratio": 0.3503481158883261}, {"date": "2025-04-11", "ratio": 0.3578107238523691}, {"date": "2025-04-15", "ratio": 0.36135336315373223}, {"date": "2025-04-16", "ratio": 0.360742750840544}, {"date": "2025-04-17", "ratio": 0.3553842187018508}, {"date": "2025-04-21", "ratio": 0.35868612321791626}, {"date": "2025-04-22", "ratio": 0.3587292720520539}, {"date": "2025-04-23", "ratio": 0.3591318162107283}, {"date": "2025-04-25", "ratio": 0.35648842418784205}, {"date": "2025-04-28", "ratio": 0.3571901268060094}, {"date": "2025-04-30", "ratio": 0.35266415168774806}, {"date": "2025-05-02", "ratio": 0.3498790390484131}, {"date": "2025-05-05", "ratio": 0.35158404245098857}, {"date": "2025-05-06", "ratio": 0.349665293934273}, {"date": "2025-05-07", "ratio": 0.35258085392227534}, {"date": "2025-05-08", "ratio": 0.3472221077869967}, {"date": "2025-05-12", "ratio": 0.35764723346720323}, {"date": "2025-05-13", "ratio": 0.35944845768735495}, {"date": "2025-05-14", "ratio": 0.3669735556555546}, {"date": "2025-05-15", "ratio": 0.3674891569341755}, {"date": "2025-05-16", "ratio": 0.36778271608885765}, {"date": "2025-05-19", "ratio": 0.36923567223682074}, {"date": "2025-05-20", "ratio": 0.37093206503024234}, {"date": "2025-05-21", "ratio": 0.3710951117236821}, {"date": "2025-05-22", "ratio": 0.37300942311365026}, {"date": "2025-05-23", "ratio": 0.3721701273279242}, {"date": "2025-05-26", "ratio": 0.3734408217222008}, {"date": "2025-05-28", "ratio": 0.3732761807417043}, {"date": "2025-05-29", "ratio": 0.37657246633593194}, {"date": "2025-05-30", "ratio": 0.3714339392421224}]};
        const signalsData = {"strong_buy": [], "buy": [{"sector": "NIFTY IT", "performance_7d": 0.16025158718606392, "performance_30d": 8.065006990651447}, {"sector": "NIFTY REALTY", "performance_7d": 1.0270123773377415, "performance_30d": 8.56647734122484}], "sell": [], "strong_sell": []};

        console.log('=== DASHBOARD DEBUG INFO ===');
        console.log('Heatmap data loaded:', heatmapData.length, 'sectors');
        console.log('Sample heatmap values:', heatmapData.slice(0, 3).map(s => ({sector: s.sector, perf_30d: s.perf_30d})));
        console.log('Ratio data loaded:', Object.keys(ratioData).length, 'sectors:', Object.keys(ratioData));
        console.log('Signals loaded:', signalsData);

        // Get color for performance value
        function getPerformanceColor(perf) {
            if (perf > 15) return { bg: '#27ae60', color: 'white' };
            if (perf > 7) return { bg: '#f39c12', color: 'white' };
            if (perf > 0) return { bg: '#2ecc71', color: 'white' };
            if (perf > -7) return { bg: '#e74c3c', color: 'white' };
            return { bg: '#8e44ad', color: 'white' };
        }

        // Generate heatmap table
        function generateHeatmap() {
            const tbody = document.getElementById('heatmapBody');

            heatmapData.forEach(sector => {
                const row = document.createElement('tr');

                // Sector name cell
                const sectorCell = document.createElement('td');
                sectorCell.className = 'sector-name';
                sectorCell.textContent = sector.sector.replace('NIFTY ', '').replace('Nifty ', '');
                row.appendChild(sectorCell);

                // Performance cells
                [sector.perf_7d, sector.perf_30d, sector.perf_90d].forEach(perf => {
                    const cell = document.createElement('td');
                    cell.textContent = perf.toFixed(1) + '%';

                    const colors = getPerformanceColor(perf);
                    cell.style.background = colors.bg;
                    cell.style.color = colors.color;

                    row.appendChild(cell);
                });

                tbody.appendChild(row);
            });
        }

        // Generate signals
        function generateSignals() {
            const containers = {
                'strong_buy': document.getElementById('strongBuySignals'),
                'buy': document.getElementById('buySignals'),
                'sell': document.getElementById('sellSignals'),
                'strong_sell': document.getElementById('strongSellSignals')
            };

            Object.keys(signalsData).forEach(signalType => {
                const container = containers[signalType];
                const signals = signalsData[signalType];

                if (signals.length === 0) {
                    container.innerHTML = '<div class="signal-item">No signals detected</div>';
                } else {
                    signals.forEach(signal => {
                        const item = document.createElement('div');
                        item.className = 'signal-item';
                        item.innerHTML = `${signal.sector.replace('NIFTY ', '').replace('Nifty ', '')}<br>
                                        30d: ${signal.performance_30d.toFixed(1)}% | 7d: ${signal.performance_7d.toFixed(1)}%`;
                        container.appendChild(item);
                    });
                }
            });
        }

        // Create ratio trends chart
        function createRatioChart() {
            const ctx = document.getElementById('ratioChart').getContext('2d');

            console.log('Creating ratio chart with data:', Object.keys(ratioData));

            if (Object.keys(ratioData).length === 0) {
                ctx.font = '16px Arial';
                ctx.fillStyle = '#666';
                ctx.textAlign = 'center';
                ctx.fillText('No ratio data available', ctx.canvas.width / 2, ctx.canvas.height / 2);
                return;
            }

            const datasets = Object.keys(ratioData).map((sector, index) => {
                const colors = ['#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6', '#1abc9c', '#34495e', '#e67e22', '#95a5a6', '#16a085'];
                const data = ratioData[sector];

                console.log(`Ratio data for ${sector}:`, data.length, 'points');

                return {
                    label: sector,
                    data: data.map(d => ({ x: d.date, y: d.ratio })),
                    borderColor: colors[index % colors.length],
                    backgroundColor: colors[index % colors.length] + '30',
                    tension: 0.4,
                    fill: false,
                    pointRadius: 1,
                    pointHoverRadius: 4
                };
            });

            new Chart(ctx, {
                type: 'line',
                data: { datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                unit: 'day',
                                displayFormats: {
                                    day: 'MMM dd'
                                }
                            },
                            title: {
                                display: true,
                                text: 'Date'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Sector/Nifty Ratio'
                            },
                            beginAtZero: false
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                boxWidth: 12,
                                padding: 8
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white'
                        }
                    }
                }
            });
        }

        // Create performance chart
        function createPerformanceChart() {
            const ctx = document.getElementById('performanceChart').getContext('2d');

            console.log('Creating performance chart...');
            console.log('Sample performance values:', heatmapData.slice(0, 5).map(d => d.perf_30d));

            const sortedData = [...heatmapData].sort((a, b) => b.perf_30d - a.perf_30d);
            const labels = sortedData.map(d => d.sector.replace('NIFTY ', '').replace('Nifty ', ''));
            const data = sortedData.map(d => d.perf_30d);

            console.log('Performance chart data range:', Math.min(...data), 'to', Math.max(...data));

            const colors = data.map(value => {
                if (value > 15) return '#27ae60';
                if (value > 7) return '#f39c12';
                if (value > 0) return '#2ecc71';
                if (value > -7) return '#e74c3c';
                return '#8e44ad';
            });

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels,
                    datasets: [{
                        label: '30-Day Relative Performance (%)',
                        backgroundColor: colors,
                        borderColor: colors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Relative Performance (%)'
                            },
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Sectors'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            callbacks: {
                                label: function(context) {
                                    return context.parsed.x.toFixed(2) + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing dashboard...');

            generateHeatmap();
            generateSignals();

            // Add delay to ensure canvas elements are ready
            setTimeout(() => {
                createRatioChart();
                createPerformanceChart();
                console.log('Dashboard initialization complete');
            }, 200);
        });
    </script>
</body>
</html>
        